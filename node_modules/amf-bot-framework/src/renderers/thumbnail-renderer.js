import builder from 'botbuilder';
import helper from './card-helper';

/**
 * Renderer for thumbnail cards.
 */
class ThumbnailRenderer {

  /**
   * Renderer for thumbnail cards.
   *
   * @constructor
   * @param bot { Object } Parent bot of the renderer.
   */
  constructor(bot) {
    this.bot = bot;
  }

  /**
   * Main render method of the class. Renders the card into Microsoft Bot
   * Framework objects, and send them to the front.
   *
   * @param session { Object } Chat session.
   * @param card { Object } Card instance.
   * @param cb { Function } Callback function.
   */
  render(session, card, cb) {
    this.bot.domain.renderObj(session, card, function(error, card) {
      if (error) {
        return cb(error);
      }
      var resultCard = helper.buildCard(session, card);
      var msg = new builder.Message(session).attachments([resultCard]);
      session.send(msg);
      return cb(null, resultCard);
    });
  }
}

export default ThumbnailRenderer;
