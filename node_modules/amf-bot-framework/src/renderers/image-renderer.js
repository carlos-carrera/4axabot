import builder from 'botbuilder';

/**
 * Renderer for image cards.
 *
 * @constructor
 * @param bot { Object } Parent bot of the renderer.
 */
class ImageRenderer {

  /**
   * Renderer for image cards.
   *
   * @constructor
   * @param bot { Object } Parent bot of the renderer.
   */
  constructor(bot) {
    this.bot = bot;
  }

  /**
   * Main render method of the class. Renders the card into Microsoft Bot
   * Framework objects, and send them to the front.
   *
   * @param session { Object } Chat session.
   * @param card { Object } Card instance.
   * @param cb { Function } Callback function.
   */
  render(session, card, cb) {
    this.bot.domain.renderObj(session, card, function(error, card) {
      if (error) {
        return cb(error);
      }
      var msg = new builder.Message(session);
      for (var i = 0; i < card.images.length; i++) {
        msg.addAttachment(card.images[i]);
      }
      session.send(msg);
      return cb(null, msg);
    });
  }
}

export default ImageRenderer;